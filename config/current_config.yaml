# Trading Configuration - PRODUCTION (CURRENT)
# Symlink reference to trading_config.yaml
# Created for test compatibility (TradingConfigLoader expects {version}_config.yaml)
# Contrato: GTR-008
# Fecha: 2026-01-14
# Basado en: Analisis de 4 agentes + feedback experto

model:
  name: ppo_primary
  version: "current"
  observation_dim: 15
  action_space: 3  # HOLD, LONG, SHORT

training:
  learning_rate: 3.0e-4
  n_steps: 2048
  batch_size: 64
  n_epochs: 10
  ent_coef: 0.05  # More exploration
  clip_range: 0.2
  gamma: 0.90  # Shorter-term focus for noisy data
  gae_lambda: 0.95
  total_timesteps: 500000
  eval_freq: 25000
  checkpoint_freq: 50000

thresholds:
  long: 0.33  # Wider HOLD zone
  short: -0.33
  confidence_min: 0.6

features:
  norm_stats_path: "config/norm_stats.json"
  clip_range: [-5.0, 5.0]
  warmup_bars: 14
  core_features:
    - log_ret_5m
    - log_ret_1h
    - log_ret_4h
    - rsi_9
    - atr_pct
    - adx_14
    - dxy_z
    - dxy_change_1d
    - vix_z
    - embi_z
    - brent_change_1d
    - rate_spread
    - usdmxn_change_1d
  state_features:
    - position
    - time_normalized

trading:
  initial_capital: 10000
  transaction_cost_bps: 75  # Real USDCOP spread
  slippage_bps: 15
  max_position_size: 1.0

risk:
  max_drawdown_pct: 15.0
  daily_loss_limit_pct: 5.0
  position_limit: 1.0
  volatility_scaling: true
  max_consecutive_losses: 5
  cooldown_bars_after_losses: 12  # 1 hour cooldown (12 x 5min)

reward:
  # Transaction costs (base, additional to trading costs)
  transaction_cost_pct: 0.0002

  # Asymmetric loss penalty
  loss_penalty_multiplier: 2.0

  # Hold bonus DISABLED (was counterproductive per expert feedback)
  hold_bonus_per_bar: 0.0
  hold_bonus_requires_profit: true  # only if enabled AND profitable
  max_hold_bonus_bars: 10

  # Consistency bonus
  consecutive_win_bonus: 0.001
  max_consecutive_bonus: 5

  # Account-level drawdown penalty
  drawdown_penalty_threshold: 0.05
  drawdown_penalty_multiplier: 2.0

  # Intratrade drawdown penalty
  intratrade_dd_penalty: 0.5
  max_intratrade_dd: 0.02  # 2% threshold

  # Time decay for stale positions
  time_decay_start_bars: 24  # 2 hours (positions held > 24 bars incur decay)
  time_decay_per_bar: 0.0001  # Decay per bar after start
  time_decay_losing_multiplier: 2.0  # 2x decay rate for losing positions

  # Reward clipping
  min_reward: -1.0
  max_reward: 1.0

# Volatility filter
volatility:
  enable_filter: true
  max_atr_multiplier: 2.0  # Force HOLD if ATR > 2x historical mean
  force_hold_in_extreme: true
  regime_lookback_bars: 60

dates:
  training_start: "2020-03-01"
  training_end: "2024-12-31"
  validation_start: "2025-01-01"
  validation_end: "2025-06-30"
  test_start: "2025-07-01"
