# =============================================================================
# Alembic Configuration for USD/COP RL Trading System
# =============================================================================
#
# This file configures Alembic database migrations for the trading system.
#
# IMPORTANT: The DATABASE_URL environment variable takes precedence over
# sqlalchemy.url configured here. In production, always use DATABASE_URL.
#
# Usage:
#   # Run all pending migrations
#   cd database && alembic upgrade head
#
#   # Generate new migration from model changes
#   cd database && alembic revision --autogenerate -m "Add new column"
#
#   # Show migration history
#   cd database && alembic history
#
#   # Show current revision
#   cd database && alembic current
#
#   # Generate SQL without applying (offline mode)
#   cd database && alembic upgrade head --sql > migration.sql
#
# =============================================================================

[alembic]
# Path to migration scripts (relative to this file)
script_location = alembic

# Template used for generating new migration files
file_template = %%(year)d%%(month).2d%%(day).2d_%%(hour).2d%%(minute).2d%%(second).2d_%%(slug)s

# Timezone for revision timestamps
# timezone = UTC

# Max length of revision ID (12 chars is default)
truncate_slug_length = 40

# Set to 'true' to run migrations within a transaction per migration file
# Recommended for PostgreSQL
revision_environment = false

# Set to 'true' to include all branches in --sql output
# sourceless = false

# Set to 'true' to run env.py when generating blank migrations
# version_locations = %(here)s/bar:%(here)s/bat:alembic/versions

# Version path separator for version_locations
# Use 'os' for os.pathsep (cross-platform default)
# version_path_separator = os

# Set to 'true' to prepend the current date in generated migrations
# prepend_sys_path = .

# =============================================================================
# Database Connection
# =============================================================================
#
# DEVELOPMENT ONLY: This URL is used when DATABASE_URL env var is not set.
# In production, always set DATABASE_URL environment variable.
#
# Format: postgresql://user:password@host:port/database
#
# Examples:
#   Local:  postgresql://postgres:postgres@localhost:5432/usdcop_trading
#   Docker: postgresql://trading_app:password@db:5432/trading_db
#   Remote: postgresql://user:pass@db.example.com:5432/usdcop_prod
#
sqlalchemy.url = postgresql://user:password@localhost:5432/usdcop_trading


# =============================================================================
# Logging Configuration
# =============================================================================

[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console

[formatters]
keys = generic

[logger_root]
level = WARN
handlers = console
qualname =

[logger_sqlalchemy]
level = WARN
handlers =
qualname = sqlalchemy.engine

[logger_alembic]
level = INFO
handlers =
qualname = alembic

[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[formatter_generic]
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S


# =============================================================================
# Post-write hooks (optional)
# =============================================================================
# Uncomment to run formatters after generating migrations

# [post_write_hooks]
# hooks = black, isort
#
# black.type = console_scripts
# black.entrypoint = black
# black.options = -q
#
# isort.type = console_scripts
# isort.entrypoint = isort
# isort.options = --profile black
